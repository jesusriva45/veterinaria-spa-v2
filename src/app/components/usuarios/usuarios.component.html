<!--app-modal-form *ngIf="usuarioSeleccionado" [usuario]="usuarioSeleccionado"></app-modal-form-->

<div class="row col-12">
    <!--button type="button" class="btn btn-primary " data-bs-toggle="modal" data-bs-target="#exampleModal">
    Agregar Usuario
  </button*-->



    <!--Card image-->

    <!--/Card image-->

    <!-- Card content -->


    <!--Title-->


    <div class="col-11 container d-block p-5">

        <button *ngIf="authService.hasRole('ROLE_ADMIN')" type="button" mdbBtn color="primary"
            class="relative waves-light mb-5" (click)="openModalCrud()" mdbWavesEffect>AGREGAR USUARIO</button>
        <!--div class="row">
            <div class="col-md-12 mx-auto">
                <div class="md-form">
                    <input type="text" [(ngModel)]="searchText" class="form-control" id="search" mdbInput />
                    <label for="search">Search</label>
                </div>
            </div>
        </div-->
        <table mdbTable #tableEl="mdbTable" mdbTableScroll scrollX="true" maxWidth="100vw" class="p-0 m-0">
            <thead>
                <tr class="text-center">
                    <th scope="col">#</th>
                    <th scope="col">Nombres</th>
                    <th scope="col">Apellidos</th>
                    <th scope="col">DNI</th>
                    <th scope="col">Teléfono</th>
                    <th scope="col">Correo</th>
                    <th scope="col">Fecha Nacimiento</th>
                    <th scope="col">Dirección</th>
                    <th scope="col">Departamento</th>
                    <th scope="col">Provincia</th>
                    <th scope="col">Distrito</th>
                    <th scope="col"></th>
                    <th></th>
                    <th></th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr class="text-center" *ngFor="let usuario of usuarios; let i = index">
                    <th class="align-middle"
                        *ngIf="i+1 >= mdbTablePagination.firstItemIndex && i < mdbTablePagination.lastItemIndex"> {{
                        usuario.idusuario }}</th>
                    <td class="align-middle"
                        *ngIf="i+1 >= mdbTablePagination.firstItemIndex && i < mdbTablePagination.lastItemIndex"> {{
                        usuario.nombres }}</td>
                    <td class="align-middle"
                        *ngIf="i+1 >= mdbTablePagination.firstItemIndex && i < mdbTablePagination.lastItemIndex"> {{
                        usuario.apellidos }}</td>
                    <td class="align-middle"
                        *ngIf="i+1 >= mdbTablePagination.firstItemIndex && i < mdbTablePagination.lastItemIndex"> {{
                        usuario.dni }}</td>
                    <td class="align-middle"
                        *ngIf="i+1 >= mdbTablePagination.firstItemIndex && i < mdbTablePagination.lastItemIndex"> {{
                        usuario.telefono }}</td>
                    <td class="align-middle"
                        *ngIf="i+1 >= mdbTablePagination.firstItemIndex && i < mdbTablePagination.lastItemIndex"> {{
                        usuario.correo }}</td>
                    <td class="align-middle"
                        *ngIf="i+1 >= mdbTablePagination.firstItemIndex && i < mdbTablePagination.lastItemIndex">{{
                        usuario.fechaNac }}</td>
                    <td class="align-middle"
                        *ngIf="i+1 >= mdbTablePagination.firstItemIndex && i < mdbTablePagination.lastItemIndex">{{
                        usuario.direccion }}</td>
                    <td class="align-middle"
                        *ngIf="i+1 >= mdbTablePagination.firstItemIndex && i < mdbTablePagination.lastItemIndex"> {{
                        usuario.ubigeo.departamento }}</td>
                    <td class="align-middle"
                        *ngIf="i+1 >= mdbTablePagination.firstItemIndex && i < mdbTablePagination.lastItemIndex">{{
                        usuario.ubigeo.provincia }}</td>
                    <td class="align-middle"
                        *ngIf="i+1 >= mdbTablePagination.firstItemIndex && i < mdbTablePagination.lastItemIndex"> {{
                        usuario.ubigeo.distrito }}</td>
                    <td class="align-middle"
                        *ngIf="i+1 >= mdbTablePagination.firstItemIndex && i < mdbTablePagination.lastItemIndex"
                        class="align-middle">
                        <mdb-icon (click)="openModalCrud(usuario)" type="button" fas size="2x" icon="edit">Estado
                        </mdb-icon>
                    </td>
                    <td *ngIf="i+1 >= mdbTablePagination.firstItemIndex && i < mdbTablePagination.lastItemIndex"
                        class="align-middle">
                        <mdb-icon (click)="modalEstado(usuario)" type="button" fas size="2x" icon="user-alt"></mdb-icon>

                    </td>
                    <td class="align-middle"
                        *ngIf="i+1 >= mdbTablePagination.firstItemIndex && i < mdbTablePagination.lastItemIndex"
                        class="align-middle">
                        <mdb-icon (click)="modalRol(usuario)" type="button" fas size="2x" icon="users"></mdb-icon>
                    </td>



                </tr>
            </tbody>
            <tfoot class="grey lighten-5 w-100">
                <tr>
                    <td colspan="4">
                        <mdb-table-pagination [tableEl]="tableEl" [searchDataSource]="usuarios"></mdb-table-pagination>
                    </td>
                </tr>
            </tfoot>
        </table>
    </div>







    <!--div class="card border-primary p-4">
        <div class="table-responsive">
            <table class="table" style="width:100%">
                <thead>
                    <tr class="text-center">
                        <th scope="col">#</th>
                        <th scope="col">Nombres</th>
                        <th scope="col">Apellidos</th>
                        <th scope="col">DNI</th>
                        <th scope="col">Teléfono</th>
                        <th scope="col">Correo</th>
                        <th scope="col">Fecha Nacimiento</th>
                        <th scope="col">Dirección</th>
                        <th scope="col">Departamento</th>
                        <th scope="col">Provincia</th>
                        <th scope="col">Distrito</th>
                        <th scope="col"></th>
                        <th scope="col" *ngIf="authService.hasRole('ROLE_ADMIN')"></th>
                        <th scope="col" *ngIf="authService.hasRole('ROLE_ADMIN')"></th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="text-center" *ngFor="let usuario of usuarios; let i = index">
                        <th class="align-middle">|{{ usuario.idusuario }}</th>
                        <td class="align-middle">{{ usuario.nombres }}</td>
                        <td class="align-middle">{{ usuario.apellidos }}</td>
                        <td class="align-middle">{{ usuario.dni }}</td>
                        <td class="align-middle">{{ usuario.telefono }}</td>
                        <td class="align-middle">{{ usuario.correo }}</td>
                        <td class="align-middle">{{ usuario.fechaNac }}</td>
                        <td class="align-middle">{{ usuario.direccion }}</td>
                        <td class="align-middle">{{ usuario.ubigeo.departamento }}</td>
                        <td class="align-middle">{{ usuario.ubigeo.provincia }}</td>
                        <td class="align-middle">{{ usuario.ubigeo.distrito }}</td>
                        <td class="align-middle">
                            <mdb-icon type="button" size="2x" far icon="file-alt"></mdb-icon>
                        </td>
                        <td class="align-middle" *ngIf="authService.hasRole('ROLE_ADMIN')">
                            <mdb-icon (click)="openModalCrud(usuario)" type="button" fas size="2x" icon="edit">Estado</mdb-icon>
                        </td>
                        <td class="align-middle" *ngIf="authService.hasRole('ROLE_ADMIN')">
                            <mdb-icon (click)="modalEstado(usuario)" type="button" fas size="2x" icon="user-alt"></mdb-icon>

                        </td>
                        <td class="align-middle" *ngIf="authService.hasRole('ROLE_ADMIN')">
                            <mdb-icon (click)="modalRol(usuario)" type="button" fas size="2x" icon="users"></mdb-icon>
                        </td>



                </tbody>
            </table>
        </div>
    </div-->
</div>


<!--
<input type="checkbox" class="check">
<input type="checkbox" class="check">
<input type="checkbox" class="check">
<input type="checkbox" class="check">
-->



<div mdbModal #modalUpdateEstado="mdbModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby=""
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable modal-fluid" role="document">
        <div class="modal-content p-5">
            <div class="modal-header text-center">
                <h4 class="modal-title w-100 font-weight-bold">ESTADO DE USUARIO</h4>

            </div>
            <div class="modal-body">

                <form id="form-producto" class="" enctype="multipart/form-data">
                    <div class=" md-form">

                        <select class="form-control pl-3 pr-3" [(ngModel)]="usuario.estado" name="estado">
                            <option [ngValue]=undefined selected>--- selecionar un estado ---</option>
                            <option *ngFor="let est of status" [ngValue]="est.estado">{{est.descripcion}} </option>


                            |
                        </select>

                    </div>

                </form>

            </div>
            <div class="modal-footer d-flex justify-content-center">
                <button type="button" mdbBtn color="secondary" class="waves-light" (click)="cerrarmodal()"
                    mdbWavesEffect>Cancelar</button>
                <button type="submit" mdbBtn color="primary" class="waves-light" (click)="updateEstadoForm()"
                    mdbWavesEffect>Actualizar</button>
            </div>
        </div>
    </div>
</div>



<div mdbModal #modalUpdateRol="mdbModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby=""
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable modal-fluid" role="document">
        <div class="modal-content p-5">
            <div class="modal-header text-center">
                <h4 class="modal-title w-100 font-weight-bold">ASIGNAR ROL DE USUARIO</h4>

            </div>
            <div class="modal-body">

                <form id="form-rol" class="" enctype="multipart/form-data">




                    <div class=" md-form">

                        <select [(ngModel)]="acceso_rol.rol" [compareWith]="compareRol" class="form-control pl-3 pr-3"
                            name="rol">
                            <option [ngValue]="undefined" selected>--- selecionar un rol ---</option>
                            <option *ngFor="let rol of roles" [ngValue]="rol">{{rol.descripcion}} </option>

                            |
                        </select>

                    </div>

                </form>

            </div>
            <div class="modal-footer d-flex justify-content-center">
                <button type="button" mdbBtn color="secondary" class="waves-light" (click)="cerrarmodalRol()"
                    mdbWavesEffect>Cancelar</button>
                <button type="submit" mdbBtn color="primary" class="waves-light" (click)="updateRolForm()"
                    mdbWavesEffect>Actualizar</button>
            </div>
        </div>
    </div>
</div>




<!--div mdbModal #content="mdbModal" style="overflow-y: auto" [config]="{backdrop: 'static' , keyboard: false}" class="modal fade left" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-full-height modal-left modal" role="document">
        <div class="modal-content">
            <div class="modal-header bg-secondary">
                <p class="modal-title" id="exampleModalLabel">AGREGAR USUARIO</p>
            </div>
            <div class="modal-body">


                <form id="form-usuario" [ngFormOptions]="{updateOn: 'usuario.apellidos'}" [formGroup]="myform" (ngSubmit)="verificarDatos()" class="row container me-auto ms-auto justify-content-center">


                    <fieldset class="col-12 p-5">


                        <div class="md-form ">
                            <mdb-icon fas icon="user envelope" class="prefix"></mdb-icon>
                            <input type="text" class="form-input form-control" id="nomForm" mdbInput mdbValidate [(ngModel)]="usuario.nombres" [formControl]="Nombres" required>
                            <label>Nombres</label>
                            <div class="p-1" *ngIf="(Nombres.errors && submitted ) ||((Nombres.dirty || Nombres.touched) && Nombres.invalid)">

                                <mdb-error class="mt-2" *ngIf="Nombres.errors.required ">Nombres is required</mdb-error>
                                <mdb-error class="mt-2" *ngIf="Nombres.errors.pattern ">Nombres invalido </mdb-error>
                            </div>

                        </div>


                        <div class="md-form">

                            <input type="text" class="form-control" mdbInput mdbValidate [(ngModel)]="usuario.apellidos" [formControl]="Apellidos" required>
                            <label>Apellidos</label>
                            <div class="p-1" *ngIf="(Apellidos.errors && submitted ) ||((Apellidos.dirty || Apellidos.touched) && Apellidos.invalid)">

                                <mdb-error class="mt-2" *ngIf="Apellidos.errors.required ">Correo is required</mdb-error>
                                <mdb-error class="mt-2" *ngIf="Apellidos.errors.pattern ">Patron invalido </mdb-error>
                            </div>
                        </div>


                        <div class="md-form">

                            <input type="text" class="form-control" mdbInput mdbValidate [(ngModel)]="usuario.dni" [formControl]="Dni" required>
                            <label>DNI</label>
                            <div class="p-1" *ngIf="(Dni.errors && submitted ) ||((Dni.dirty || Dni.touched) && Dni.invalid)">

                                <mdb-error class="mt-2" *ngIf="Dni.errors.required ">Correo is required</mdb-error>
                                <mdb-error class="mt-2" *ngIf="Dni.errors.pattern ">Patron invalido </mdb-error>
                            </div>
                        </div>

                        <div class="md-form ">

                            <input type="text" class="form-control" mdbInput mdbValidate [(ngModel)]="usuario.telefono" [formControl]="Telef" required>
                            <label>Telefono</label>
                            <div class="p-1" *ngIf="(Telef.errors && submitted ) ||((Telef.dirty || Telef.touched) && Telef.invalid)">

                                <mdb-error class="mt-2" *ngIf="Telef.errors.required ">Correo is required</mdb-error>
                                <mdb-error class="mt-2" *ngIf="Telef.errors.pattern ">Patron invalido </mdb-error>
                            </div>
                        </div>

                        <div class="md-form ">

                            <input type="text" class="form-control" mdbInput mdbValidate [(ngModel)]="usuario.direccion" [formControl]="Direc" required>
                            <label>Dirección</label>
                            <div class="p-1" *ngIf="(Direc.errors && submitted ) ||((Direc.dirty || Direc.touched) && Direc.invalid)">

                                <mdb-error class="mt-2" *ngIf="Direc.errors.required ">Correo is required</mdb-error>
                                <mdb-error class="mt-2" *ngIf="Direc.errors.pattern ">Patron invalido </mdb-error>
                            </div>

                        </div>

                        <div class="md-form ">

                            <input type="text" class="form-control" mdbInput mdbValidate [(ngModel)]="usuario.correo" [formControl]="Correo" required>
                            <label>Correo</label>
                            <div class="p-1" *ngIf="(Correo.errors && submitted ) ||((Correo.dirty || Correo.touched) && Correo.invalid)">

                                <mdb-error class="mt-2" *ngIf="Correo.errors.required ">Correo is required</mdb-error>
                                <mdb-error class="mt-2" *ngIf="Correo.errors.pattern ">Patron invalido </mdb-error>
                            </div>
                        </div>

                        <div class="md-form">

                            <input type="date" class="form-control" id="form58" mdbInput mdbValidate [(ngModel)]="usuario.fechaNac" [formControl]="FechaNac" required>
                            <label for="form58">Fecha Nacimiento</label>
                        </div>

                        <div class=" md-form">

                            <select [ngClass]="{
                                'is-invalid': IdUbi.invalid && (IdUbi.dirty || IdUbi.touched),
                                'is-valid': IdUbi.valid && (IdUbi.dirty || IdUbi.touched)
                              }" class="form-control" [(ngModel)]="usuario.ubigeo" [compareWith]="compareUbigeo" [formControl]="IdUbi" required>
                                
                                <option [ngValue]="null" selected>--- selecionar una región ---</option>
                                    <option *ngFor="let region of ubigeo" [ngValue]="region" > {{ region.departamento  }} - {{ region.provincia  }} - {{ region.distrito  }}</option>
                               
                                </select>

                            <div class="p-1">
                                <mdb-error class="mt-2" *ngIf="(IdUbi.errors && submitted ) ||((IdUbi.dirty || IdUbi.touched) && IdUbi.invalid)">
                                    Seleccione su ubicación
                                </mdb-error>
                            </div>

                        </div>


                    </fieldset>





                    <div class="btn-group w-100 justify-content-center d-flex" role="group" aria-label="Basic example">

                        <button type="button" mdbBtn color="secondary" class="waves-light" (click)="cerrarmodal()" mdbWavesEffect>Cancelar</button>
                        <button type="submit" mdbBtn color="primary" class="waves-light" mdbWavesEffect>Registrar</button>

                    </div>

                </form>


            </div>
            <div class="modal-footer">

            </div>
        </div>
    </div>
</div-->